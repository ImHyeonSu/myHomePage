---
sidebar_position: 1
---

# php_1

**Last updated:** _2024-01-15_

## php とは？

- 基本概念

  - Web サーバー用のプログラミング言語
  - サーバーサイドで動作
  - Web 開発に特化

- 特徴

  - 習得が比較的簡単
  - Web 機能が充実
  - 大規模コミュニティ

- 制限事項
  - 単独でサーバーとして動作不可
  - 常に Web サーバー（Nginx 等）が必要
  - リクエストごとに処理を開始

## php-fpm とは？

- PHP プロセスマネージャー

  - PHP プロセスの生成と管理
  - リクエストに応じたプロセスの割り当て
  - プロセスプールの維持

- Nginx と PHP 間の仲介者
  - Nginx からリクエストを受信
  - PHP 処理のリクエスト
  - 結果を Nginx に返送

## Laravel とは？

1.  ルーティングシステム
    - URL とコントローラーの連携
    - API エンドポイント管理
    - API バージョン管理が容易
2.  Eloquent ORM
    - データベース操作をオブジェクト指向的に処理
    - 複雑な SQL なしでデータベース操作が可能
    - モデル間の関係設定が容易
3.  認証/認可
    - ログイン/会員登録機能を標準提供
    - 権限管理システムを内蔵
    - API トークン管理機能
4.  データベース管理
    - マイグレーションでデータベース構造を管理
    - シーディングでテストデータを生成
    - 複数データベースの同時サポート
5.  ミドルウェア
    - リクエスト/レスポンスのフィルタリング
    - API 認証処理
    - CORS 処理

## backendのながれ
```
ブラウザ/クライアント → HTTPリクエスト
↓
Nginxが.phpファイルリクエストを確認
↓
PHP-FPMにリクエストを転送（主に9000ポート）
↓
PHP-FPMが処理用PHPプロセスを割り当て
↓
1) エントリーポイント (public/index.php)
   - Composerオートローダーの読み込み
   - Laravelブートストラップ実行
   
2) ブートストラップ (bootstrap/app.php)
   - サービスコンテナ生成
   - 基本サービス登録

3) HTTPカーネル実行
   - グローバルミドルウェア実行
   - 環境設定読み込み
↓
1) ルーティング
   - URLパターンマッチング
   - 該当ルートのミドルウェア実行
   
2) コントローラー実行
   - 依存性注入
   - ビジネスロジック処理
   - データベース照会/更新
   
3) Eloquent ORM
   - モデルを通したデータベース操作
   - リレーションデータ処理
↓
1) コントローラーでレスポンス生成
   - JSONデータ構成
   - ステータスコード設定
   
2) ミドルウェア逆順実行
   - レスポンスデータ加工
   - ヘッダー追加
   
3) PHP-FPM → Nginx
   - 生成されたレスポンスをNginxに転送
   
4) Nginx → クライアント
   - 最終レスポンスをクライアントに送信
```
